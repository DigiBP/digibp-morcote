package ch.fhnw.digibp;


import org.camunda.bpm.engine.delegate.DelegateExecution;
import org.camunda.bpm.engine.delegate.JavaDelegate;


//maybe we can work with that: https://docs.camunda.org/manual/7.8/user-guide/process-engine/history/#user-operation-log
public class InitVariables implements JavaDelegate {


    private DelegateExecution execution;

    private void setIfNull(String varName, String value) {

        LOGGER.info("Check variable content of '" + varName + "' defined as '" + execution.getVariable(varName) + "'");

        Object var = execution.getVariable(varName);
        if (var == null) {
            execution.setVariable(varName, value);
            LOGGER.info("set to '" + varName + "' to '" + value + "'");
        }
    }

    private void setVar(String varName, String value) {

        execution.setVariable(varName, value);
        LOGGER.info("set to '" + varName + "' to '" + value + "'");
    }



    public void execute(DelegateExecution execution) throws Exception {

        this.execution = execution;

        setIfNull("impact", "3_MEDIUM");
        setIfNull("urgency", "3_MEDIUM");
        setIfNull("priority", "3_MEDIUM");
        setIfNull("affectedApplication", "undefined");
        setIfNull("summary", "");
        setIfNull("description", "");
        setIfNull("systemID", "");
        setIfNull("stepByStep", "");
        setIfNull("customerName", "");
        setIfNull("customerMail", "");
        setIfNull("customerPhone", "");

      setVar("ticketStatus", "NEW");
        setVar("ticketOrigin", "MANUAL");

        setIfNull("isReallyIncident", "");
        setIfNull("incidentSupported", "");
        setIfNull("isCritical", "false");

    }

}